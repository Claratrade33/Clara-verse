// dashboard.js

document.addEventListener("DOMContentLoaded", function() {
    // Fun√ß√£o para obter o saldo
    function obterSaldo() {
        fetch('/obter_saldo')
            .then(response => response.json())
            .then(data => {
                if (data.saldo) {
                    document.getElementById("saldo").innerText = `üî• Saldo Atual: $${data.saldo} USDT`;
                } else {
                    console.error(data.erro);
                }
            });
    }

    // Fun√ß√£o para executar uma a√ß√£o de compra ou venda
    function executarAcao(acao) {
        fetch('/executar_acao', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ acao: acao }),
        })
        .then(response => response.json())
        .then(data => {
            if (data.mensagem) {
                alert(data.mensagem);
                obterSaldo(); // Atualiza saldo ap√≥s a a√ß√£o
            } else {
                console.error(data.erro);
            }
        });
    }

    // Fun√ß√£o para obter sugest√£o da IA
    function obterSugestaoIA() {
        fetch('/obter_sugestao_ia')
            .then(response => response.json())
            .then(data => {
                const respostaElement = document.getElementById("respostaIA").querySelector("p");
                if (data.resposta) {
                    respostaElement.innerText = data.resposta;
                } else {
                    console.error(data.erro);
                }
            });
    }

    // Chama as fun√ß√µes ao carregar o painel
    obterSaldo();
    obterSugestaoIA();

    // Adiciona event listeners para os bot√µes
    document.getElementById("comprarBtn").addEventListener("click", function() {
        executarAcao('comprar');
    });

    document.getElementById("venderBtn").addEventListener("click", function() {
        executarAcao('vender');
    });

    document.getElementById("sugerirBtn").addEventListener("click", function() {
        obterSugestaoIA();
    });
});